# GraphQL vs REST API ガイドライン

このガイドは、Shopify MCP ServerでGraphQLとREST APIをいつ使い分けるべきかについて説明します。

## GraphQLとRESTの違い

### GraphQL
- **単一エンドポイント**: すべてのリクエストが同じエンドポイントに送信されます
- **柔軟なレスポンス**: 必要なフィールドのみを指定できます
- **複数リソースの一括取得**: 1回のリクエストで複数のリソースを取得できます
- **型安全**: スキーマにより型が保証されます

### REST
- **複数エンドポイント**: リソースごとに異なるエンドポイント
- **固定レスポンス**: 事前定義されたレスポンス形式
- **シンプルな実装**: 標準的なHTTPメソッドを使用
- **キャッシュしやすい**: HTTPキャッシュが効果的に機能

## 使い分けの指針

### GraphQLを使うべき場合
1. **複雑なデータ構造**を扱う場合
   - 商品と在庫の同時取得
   - 顧客情報と注文履歴の結合

2. **ネットワーク効率**が重要な場合
   - モバイルアプリケーション
   - 帯域幅が限られた環境

3. **特定のフィールドのみ**が必要な場合
   - レポート生成
   - ダッシュボード表示

### RESTを使うべき場合
1. **シンプルなCRUD操作**
   - 単体リソースの作成、更新、削除
   - 基本的な一覧取得

2. **キャッシュ**が重要な場合
   - 静的コンテンツ
   - 頻繁にアクセスされるデータ

3. **レガシー統合**が必要な場合
   - 既存システムとの互換性
   - 標準的なHTTPツールの使用

## パフォーマンス比較

| 観点 | GraphQL | REST |
|------|---------|------|
| リクエスト回数 | 少ない（一括取得可能） | 多い（個別取得） |
| レスポンスサイズ | 最適化可能 | 固定 |
| キャッシュ効率 | 低い | 高い |
| 実装複雑度 | 高い | 低い |

## 具体的な使用例

### GraphQLの使用例
```python
# 商品と在庫を一括取得
result = get_products_graphql(limit=50)
# 必要なフィールドのみを取得し、ネットワーク負荷を削減
```

### RESTの使用例
```python
# 単一商品の更新
api.update_product(product_id, {"title": "新商品名"})
# シンプルな操作には RESTが適している
```

## 推奨事項

1. **読み取り操作**
   - 複雑なクエリ: GraphQL
   - 単純な取得: REST

2. **書き込み操作**
   - 基本的にREST（シンプルで確実）
   - 複雑な関連更新: GraphQL mutation

3. **リアルタイム要件**
   - GraphQL Subscriptions（将来実装予定）
   - REST Webhooks

## まとめ

Shopify MCP Serverでは、両方のAPIを適材適所で使用することを推奨します。GraphQLは複雑なデータ取得に、RESTはシンプルな操作に最適です。プロジェクトの要件に応じて、適切なAPIを選択してください。