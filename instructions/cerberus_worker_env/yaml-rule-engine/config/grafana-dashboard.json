{
  "dashboard": {
    "id": null,
    "uid": "yaml-rule-engine",
    "title": "YAML Rule Engine - 革新的メトリクスダッシュボード",
    "tags": ["cerberus", "ai", "neural", "rules"],
    "timezone": "browser",
    "schemaVersion": 30,
    "version": 1,
    "refresh": "5s",
    "panels": [
      {
        "id": 1,
        "gridPos": { "x": 0, "y": 0, "w": 12, "h": 8 },
        "type": "graph",
        "title": "LLM判断の可視化 - ルール適用履歴",
        "targets": [
          {
            "expr": "yaml_rule_engine_total_evaluations",
            "legendFormat": "総評価数"
          },
          {
            "expr": "yaml_rule_engine_match_rate * 100",
            "legendFormat": "マッチ率 (%)"
          }
        ],
        "yaxes": [
          { "format": "short", "label": "評価数" },
          { "format": "percent", "label": "マッチ率" }
        ]
      },
      {
        "id": 2,
        "gridPos": { "x": 12, "y": 0, "w": 12, "h": 8 },
        "type": "heatmap",
        "title": "神経網活性化パターン",
        "targets": [
          {
            "expr": "yaml_rule_engine_neural_activation_pattern",
            "format": "heatmap"
          }
        ],
        "dataFormat": "timeseries",
        "yAxis": { "format": "short" },
        "color": {
          "mode": "spectrum",
          "scheme": "interpolateRdYlGn"
        }
      },
      {
        "id": 3,
        "gridPos": { "x": 0, "y": 8, "w": 8, "h": 6 },
        "type": "stat",
        "title": "神経網型ツール選択の成功率",
        "targets": [
          {
            "expr": "yaml_rule_engine_neural_success_rate * 100",
            "instant": true
          }
        ],
        "options": {
          "graphMode": "area",
          "colorMode": "value",
          "unit": "percent",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": null },
              { "color": "yellow", "value": 70 },
              { "color": "green", "value": 85 }
            ]
          }
        }
      },
      {
        "id": 4,
        "gridPos": { "x": 8, "y": 8, "w": 8, "h": 6 },
        "type": "gauge",
        "title": "システム進化速度",
        "targets": [
          {
            "expr": "yaml_rule_engine_learning_rate * 100",
            "instant": true
          }
        ],
        "options": {
          "showThresholdLabels": true,
          "showThresholdMarkers": true,
          "unit": "percent",
          "min": -10,
          "max": 10,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "red", "value": -10 },
              { "color": "yellow", "value": 0 },
              { "color": "green", "value": 5 }
            ]
          }
        }
      },
      {
        "id": 5,
        "gridPos": { "x": 16, "y": 8, "w": 8, "h": 6 },
        "type": "timeseries",
        "title": "処理時間とニューラル信頼度",
        "targets": [
          {
            "expr": "yaml_rule_engine_avg_processing_time_ms",
            "legendFormat": "平均処理時間 (ms)"
          },
          {
            "expr": "yaml_rule_engine_neural_confidence * 100",
            "legendFormat": "ニューラル信頼度 (%)",
            "yaxis": 2
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "lineInterpolation": "smooth",
              "spanNulls": true
            }
          }
        }
      },
      {
        "id": 6,
        "gridPos": { "x": 0, "y": 14, "w": 12, "h": 8 },
        "type": "bargauge",
        "title": "ルール別パフォーマンス",
        "targets": [
          {
            "expr": "topk(10, yaml_rule_engine_rule_success_rate)",
            "legendFormat": "{{rule_id}}"
          }
        ],
        "options": {
          "displayMode": "gradient",
          "orientation": "horizontal",
          "unit": "percentunit"
        }
      },
      {
        "id": 7,
        "gridPos": { "x": 12, "y": 14, "w": 12, "h": 8 },
        "type": "alertlist",
        "title": "AI駆動異常検知アラート",
        "options": {
          "showOptions": "current",
          "maxItems": 10,
          "sortOrder": 1,
          "dashboardAlerts": true,
          "alertName": "",
          "dashboardTitle": "",
          "tags": []
        }
      },
      {
        "id": 8,
        "gridPos": { "x": 0, "y": 22, "w": 24, "h": 6 },
        "type": "graph",
        "title": "予測分析 - 負荷とパフォーマンストレンド",
        "targets": [
          {
            "expr": "predict_linear(yaml_rule_engine_total_evaluations[1h], 3600)",
            "legendFormat": "予測負荷（1時間後）"
          },
          {
            "expr": "yaml_rule_engine_anomaly_probability * 100",
            "legendFormat": "異常発生確率 (%)"
          }
        ],
        "yaxes": [
          { "format": "short" },
          { "format": "percent" }
        ]
      }
    ]
  },
  "inputs": [
    {
      "name": "DS_PROMETHEUS",
      "label": "Prometheus",
      "description": "",
      "type": "datasource",
      "pluginId": "prometheus",
      "pluginName": "Prometheus"
    }
  ],
  "requires": {
    "grafanaVersion": "8.0.0",
    "plugins": []
  }
}